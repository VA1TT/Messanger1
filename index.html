<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aqua Messenger</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js" defer></script>
    <script src="app.js" defer></script>
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <!-- Preloader -->
    <div class="preloader" id="preloader">
        <div class="preloader-content">
            <div class="liquid-loader">
                <div class="liquid-drop"></div>
                <div class="liquid-drop"></div>
                <div class="liquid-drop"></div>
                <div class="liquid-drop"></div>
            </div>
            <div class="preloader-text">Aqua Messenger</div>
        </div>
    </div>

    <!-- Auth Section -->
    <div class="auth-section" id="authSection">
        <div class="auth-container">
            <div class="glass-card auth-card">
                <div class="logo-container">
                    <div class="liquid-logo">
                        <div class="liquid-wave"></div>
                        <div class="liquid-wave"></div>
                        <div class="liquid-wave"></div>
                    </div>
                    <h1 class="logo-text">Aqua Messenger</h1>
                </div>
                
                <div class="auth-form" id="authForm">
                    <div class="form-header">
                        <h2 id="authTitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h2>
                        <div class="auth-tabs">
                            <button class="tab-btn active" data-tab="login">–í—Ö–æ–¥</button>
                            <button class="tab-btn" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                        </div>
                    </div>
                    
                    <div class="error-message" id="authError"></div>
                    
                    <form id="loginForm" class="form-content active">
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="loginUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ Email" required>
                        </div>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                            <button type="button" class="show-password" data-input="loginPassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <button type="submit" class="btn-primary liquid-btn">
                            <span>–í–æ–π—Ç–∏</span>
                        </button>
                    </form>
                    
                    <form id="registerForm" class="form-content">
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="registerUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                        </div>
                        <div class="input-group">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="registerEmail" placeholder="Email" required>
                        </div>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="registerPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                            <button type="button" class="show-password" data-input="registerPassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="registerConfirmPassword" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                        </div>
                        <button type="submit" class="btn-primary liquid-btn">
                            <span>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container" id="appContainer" style="display: none;">
        <!-- Left Sidebar -->
        <div class="left-sidebar" id="leftSidebar">
            <div class="sidebar-header">
                <div class="user-avatar-small" id="userAvatarSmall">
                    <img src="" alt="Avatar" id="currentAvatar">
                    <div class="status-indicator online" id="statusIndicator"></div>
                </div>
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <div class="sidebar-content" id="sidebarContent">
                <nav class="main-nav">
                    <a href="#" class="nav-item active" data-section="chats">
                        <i class="fas fa-comments"></i>
                        <span>–ß–∞—Ç—ã</span>
                    </a>
                    <a href="#" class="nav-item" data-section="calls">
                        <i class="fas fa-phone"></i>
                        <span>–ó–≤–æ–Ω–∫–∏</span>
                    </a>
                    <a href="#" class="nav-item" data-section="search">
                        <i class="fas fa-search"></i>
                        <span>–ü–æ–∏—Å–∫</span>
                    </a>
                    <a href="#" class="nav-item" data-section="scroll">
                        <i class="fas fa-play-circle"></i>
                        <span>Scroll</span>
                    </a>
                    <a href="#" class="nav-item" data-section="friends">
                        <i class="fas fa-user-friends"></i>
                        <span>–î—Ä—É–∑—å—è</span>
                    </a>
                    <a href="#" class="nav-item" data-section="settings">
                        <i class="fas fa-cog"></i>
                        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                    </a>
                </nav>
                
                <div class="friends-list-collapsed">
                    <div class="friends-header">
                        <h4>–î—Ä—É–∑—å—è</h4>
                    </div>
                    <div class="friends-avatars" id="friendsAvatars">
                        <!-- –ê–≤–∞—Ç–∞—Ä–∫–∏ –¥—Ä—É–∑–µ–π –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
                
                <div class="user-profile">
                    <div class="user-info-expanded">
                        <div class="user-avatar-large">
                            <img src="" alt="Avatar" id="currentAvatarLarge">
                            <button class="avatar-edit" id="avatarEditBtn">
                                <i class="fas fa-camera"></i>
                            </button>
                        </div>
                        <div class="user-details">
                            <h4 id="currentUsername"></h4>
                            <div class="status-selector" id="statusSelector">
                                <span class="current-status" id="currentStatus">–û–Ω–ª–∞–π–Ω</span>
                                <div class="status-options">
                                    <div class="status-option online" data-status="online">
                                        <div class="status-dot"></div>
                                        <span>–û–Ω–ª–∞–π–Ω</span>
                                    </div>
                                    <div class="status-option dnd" data-status="dnd">
                                        <div class="status-dot"></div>
                                        <span>–ù–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å</span>
                                    </div>
                                    <div class="status-option away" data-status="away">
                                        <div class="status-dot"></div>
                                        <span>–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Chats Section -->
            <div class="content-section active" id="chatsSection">
                <div class="chats-container">
                    <div class="chats-sidebar">
                        <div class="chats-header">
                            <h2>–ß–∞—Ç—ã</h2>
                            <button class="btn-icon" id="newChatBtn">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="–ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤..." id="chatSearch">
                        </div>
                        <div class="chats-list" id="chatsList">
                            <!-- –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                    <div class="chat-window">
                        <div class="chat-header" id="chatHeader">
                            <div class="chat-partner-info">
                                <div class="partner-avatar">
                                    <img src="" alt="" id="partnerAvatar">
                                    <div class="partner-status" id="partnerStatus"></div>
                                </div>
                                <div class="partner-details">
                                    <h3 id="partnerName">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç</h3>
                                    <p id="partnerStatusText">...</p>
                                </div>
                            </div>
                            <div class="chat-actions">
                                <button class="btn-icon" id="videoCallBtn" title="–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫">
                                    <i class="fas fa-video"></i>
                                </button>
                                <button class="btn-icon" id="voiceCallBtn" title="–ì–æ–ª–æ—Å–æ–≤–æ–π –∑–≤–æ–Ω–æ–∫">
                                    <i class="fas fa-phone"></i>
                                </button>
                                <div class="dropdown">
                                    <button class="btn-icon" title="–ï—â–µ">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        <a href="#" id="clearChatBtn"><i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç</a>
                                        <a href="#" id="changeWallpaperBtn"><i class="fas fa-image"></i> –û–±–æ–∏ —á–∞—Ç–∞</a>
                                        <a href="#" id="chatSettingsBtn"><i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="messages-container" id="messagesContainer">
                            <div class="chat-background" id="chatBackground"></div>
                            <div class="messages" id="messages">
                                <div class="welcome-message">
                                    <div class="welcome-icon">
                                        <i class="fas fa-comment-dots"></i>
                                    </div>
                                    <h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Aqua Messenger!</h3>
                                    <p>–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="message-input-container">
                            <button class="btn-icon" id="attachFileBtn">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <input type="file" id="fileInput" accept="image/*,video/*,.pdf,.doc,.docx,.txt" style="display: none;">
                            <div class="message-input-wrapper">
                                <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." disabled>
                                <div class="input-actions">
                                    <button class="btn-icon" id="emojiBtn">
                                        <i class="far fa-smile"></i>
                                    </button>
                                </div>
                            </div>
                            <button class="btn-primary send-btn" id="sendBtn" disabled>
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calls Section -->
            <div class="content-section" id="callsSection">
                <div class="calls-container">
                    <h2>–ò—Å—Ç–æ—Ä–∏—è –∑–≤–æ–Ω–∫–æ–≤</h2>
                    <div class="calls-list" id="callsList">
                        <!-- –ò—Å—Ç–æ—Ä–∏—è –∑–≤–æ–Ω–∫–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <!-- Search Section -->
            <div class="content-section" id="searchSection">
                <div class="search-container">
                    <h2>–ü–æ–∏—Å–∫</h2>
                    <div class="global-search">
                        <input type="text" placeholder="–ü–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ñ–∞–π–ª–æ–≤..." id="globalSearch">
                        <button class="btn-primary">
                            <i class="fas fa-search"></i> –ù–∞–π—Ç–∏
                        </button>
                    </div>
                    <div class="search-results" id="searchResults">
                        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <!-- Scroll Section -->
            <div class="content-section" id="scrollSection">
                <div class="scroll-container">
                    <div class="scroll-header">
                        <h2>Scroll</h2>
                        <button class="btn-primary" id="uploadVideoBtn">
                            <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ
                        </button>
                    </div>
                    <input type="file" id="videoUploadInput" accept="video/*" style="display: none;">
                    <div class="videos-grid" id="videosGrid">
                        <!-- –í–∏–¥–µ–æ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <!-- Friends Section -->
            <div class="content-section" id="friendsSection">
                <div class="friends-container">
                    <div class="friends-tabs">
                        <button class="tab-btn active" data-friends-tab="all">–í—Å–µ –¥—Ä—É–∑—å—è</button>
                        <button class="tab-btn" data-friends-tab="online">–û–Ω–ª–∞–π–Ω</button>
                        <button class="tab-btn" data-friends-tab="pending">–ó–∞–ø—Ä–æ—Å—ã</button>
                        <button class="tab-btn" data-friends-tab="suggestions">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</button>
                    </div>
                    <div class="friends-list-expanded" id="friendsListExpanded">
                        <!-- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="content-section" id="settingsSection">
                <div class="settings-container">
                    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                    <div class="settings-grid">
                        <div class="settings-card">
                            <h3><i class="fas fa-palette"></i> –í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h3>
                            <div class="setting-item">
                                <span>–¢–µ–º–∞</span>
                                <select id="themeSelect">
                                    <option value="dark">–¢–µ–º–Ω–∞—è</option>
                                    <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
                                    <option value="auto">–ê–≤—Ç–æ</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <span>–û–±–æ–∏ —á–∞—Ç–∞</span>
                                <button class="btn-secondary" id="selectWallpaperBtn">–í—ã–±—Ä–∞—Ç—å –æ–±–æ–∏</button>
                            </div>
                            <div class="setting-item">
                                <span>–ê–Ω–∏–º–∞—Ü–∏–∏</span>
                                <label class="switch">
                                    <input type="checkbox" id="animationsToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="settings-card">
                            <h3><i class="fas fa-user"></i> –ü—Ä–æ—Ñ–∏–ª—å</h3>
                            <div class="avatar-upload">
                                <div class="avatar-preview" id="avatarPreview">
                                    <img src="" alt="" id="previewAvatar">
                                </div>
                                <button class="btn-secondary" id="uploadAvatarBtn">–ò–∑–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</button>
                            </div>
                            <div class="setting-item">
                                <span>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
                                <input type="text" id="usernameInput" value="">
                            </div>
                        </div>
                        
                        <div class="settings-card">
                            <h3><i class="fas fa-bell"></i> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                            <div class="setting-item">
                                <span>–ó–≤—É–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π</span>
                                <label class="switch">
                                    <input type="checkbox" id="messageSoundsToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–≤–æ–Ω–∫–∞—Ö</span>
                                <label class="switch">
                                    <input type="checkbox" id="callNotificationsToggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Call Modal -->
    <div class="call-modal" id="callModal" style="display: none;">
        <div class="call-container glass-card">
            <div class="call-header">
                <h3>–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–≤–æ–Ω–∫–∞</h3>
                <div class="call-loader">
                    <div class="liquid-ring"></div>
                </div>
            </div>
            <div class="call-info">
                <p id="callPartnerName">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å...</p>
                <div class="call-timer" id="callTimer">00:00</div>
            </div>
            <div class="call-controls">
                <button class="btn-call accept" id="acceptCallBtn">
                    <i class="fas fa-phone"></i>
                </button>
                <button class="btn-call decline" id="declineCallBtn">
                    <i class="fas fa-phone-slash"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Video Call Interface -->
    <div class="video-call-container" id="videoCallContainer" style="display: none;">
        <video id="localVideo" autoplay muted playsinline></video>
        <video id="remoteVideo" autoplay playsinline></video>
        <div class="video-controls">
            <button class="video-control-btn" id="videoToggleBtn">
                <i class="fas fa-video"></i>
            </button>
            <button class="video-control-btn" id="audioToggleBtn">
                <i class="fas fa-microphone"></i>
            </button>
            <button class="video-control-btn end-call" id="endCallBtn">
                <i class="fas fa-phone-slash"></i>
            </button>
        </div>
    </div>

    <!-- Emoji Picker -->
    <div class="emoji-picker" id="emojiPicker" style="display: none;">
        <div class="emoji-categories">
            <button class="emoji-category-btn active" data-category="smileys">üòÄ</button>
            <button class="emoji-category-btn" data-category="animals">üêª</button>
            <button class="emoji-category-btn" data-category="food">üçï</button>
        </div>
        <div class="emoji-grid" id="emojiGrid">
            <!-- –≠–º–æ–¥–∑–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
    </div>

    <!-- File Upload Preview -->
    <div class="file-preview-modal" id="filePreviewModal" style="display: none;">
        <div class="file-preview-container glass-card">
            <div class="file-preview-header">
                <h3>–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞</h3>
                <button class="close-btn" id="closePreviewBtn">&times;</button>
            </div>
            <div class="file-preview-content" id="filePreviewContent">
                <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <div class="file-preview-actions">
                <input type="text" id="fileCaption" placeholder="–î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–ø–∏—Å—å...">
                <button class="btn-primary" id="sendFileBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="notification-toast" id="notificationToast">
        <div class="toast-content">
            <i class="fas fa-bell"></i>
            <div class="toast-message" id="toastMessage"></div>
        </div>
    </div>
</body>
</html>
